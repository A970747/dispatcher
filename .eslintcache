[{"/home/a970747/coding/dispatcher/src/index.js":"1","/home/a970747/coding/dispatcher/src/App.js":"2","/home/a970747/coding/dispatcher/src/store/reducers/orderReducer.js":"3","/home/a970747/coding/dispatcher/src/store/reducers/routeReducer.js":"4","/home/a970747/coding/dispatcher/src/store/actions/orderAction.js":"5","/home/a970747/coding/dispatcher/src/store/actions/routeAction.js":"6","/home/a970747/coding/dispatcher/src/components/GenRoutes.js":"7"},{"size":726,"mtime":1611549689473,"results":"8","hashOfConfig":"9"},{"size":8550,"mtime":1611626377026,"results":"10","hashOfConfig":"9"},{"size":370,"mtime":1611546189110,"results":"11","hashOfConfig":"9"},{"size":315,"mtime":1611326596894,"results":"12","hashOfConfig":"9"},{"size":708,"mtime":1611546152782,"results":"13","hashOfConfig":"9"},{"size":473,"mtime":1611546766023,"results":"14","hashOfConfig":"9"},{"size":6038,"mtime":1611625588294,"results":"15","hashOfConfig":"9"},{"filePath":"16","messages":"17","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"18","usedDeprecatedRules":"19"},"1cujjw6",{"filePath":"20","messages":"21","errorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"22","messages":"23","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"19"},{"filePath":"24","messages":"25","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"19"},{"filePath":"26","messages":"27","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"19"},{"filePath":"28","messages":"29","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"19"},{"filePath":"30","messages":"31","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"32","usedDeprecatedRules":"19"},"/home/a970747/coding/dispatcher/src/index.js",["33","34","35"],"import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport {Provider} from 'react-redux';\nimport {createStore, combineReducers} from 'redux';\nimport orderReducer from  './store/reducers/orderReducer';\nimport routeReducer from  './store/reducers/routeReducer';\nimport { addOrder } from './store/actions/orderAction';\nimport { addRoute } from './store/actions/routeAction';\n\nconst transitReducer = combineReducers({\n  orders: orderReducer,\n  routes: routeReducer,\n});\n\nconst store = createStore(transitReducer);\n\nReactDOM.render(\n  <Provider store={store} >\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n\nlet order = {\n  origin: 'Toronto, ON',\n  destination: 'Montreal, QC',\n}",["36","37"],"/home/a970747/coding/dispatcher/src/App.js",["38","39","40","41","42","43","44","45","46"],"/home/a970747/coding/dispatcher/src/store/reducers/orderReducer.js",[],"/home/a970747/coding/dispatcher/src/store/reducers/routeReducer.js",[],"/home/a970747/coding/dispatcher/src/store/actions/orderAction.js",[],"/home/a970747/coding/dispatcher/src/store/actions/routeAction.js",[],"/home/a970747/coding/dispatcher/src/components/GenRoutes.js",["47","48","49","50","51"],"import React, {useEffect, useState} from 'react';\nimport {addRoute} from '../store/actions/routeAction'\nimport {deleteAllOrders} from '../store/actions/orderAction'\nimport {useSelector, useDispatch} from 'react-redux';\nimport {Button, ButtonGroup} from '@material-ui/core';\n\nfunction GenRoutes({orderMap, removeOrders}) {\n  const [indexes, setIndexes] = useState([]);\n  const [result, setResult] = useState([]);\n  const [route, setRoute] = useState('');\n  const [stopsArray, setStopsArray] = useState([]);\n  const [polylineArray, setPolylineArray] = useState([]);\n  const orders = useSelector(state => state.orders);\n  const routes = useSelector(state => state.routes);\n  const dispatch = useDispatch();\n\n  useEffect(() => {if(orders.length > 0) calcStraightLineDist()}, [orders]);\n\n  useEffect(() => {\n    let tempArray = [];\n    orders.forEach((each, index) => tempArray.push(index))\n    setIndexes(tempArray);\n  }, [orders])\n\n  useEffect(() => {\n    mapRoutes(routes);\n  }, [routes])\n\n  async function optimize() {\n    let tempArray = [...indexes];\n    let result = getPermutations(tempArray);\n    let shortest = getShortest(result);\n    let newRoute = await drawRoute(result[shortest.index]);\n    let stops = getStops(result[shortest.index])\n    setRoute(newRoute);\n    setStopsArray(stops);\n    setResult(result);\n  }\n\n  function createRoute() {\n    let routeObj = {};\n    routeObj.path = stopsArray;\n    routeObj.route = route;\n    routeObj.orders = orders;\n\n    dispatch(addRoute(routeObj));\n    dispatch(deleteAllOrders())\n    removeOrders();\n  }\n\n  function getPermutations(array) {\n    let ret = [];\n  \n    for (let i = 0; i < array.length; i = i + 1) {\n      let rest = getPermutations(array.slice(0, i).concat(array.slice(i + 1)));\n  \n      if(!rest.length) {\n        ret.push([array[i]])\n      } else {\n        for(let j = 0; j < rest.length; j = j + 1) {\n          ret.push([array[i]].concat(rest[j]))\n        }\n      }\n    }\n    return ret\n  };\n  \n  function getShortest(result) {\n    const length = indexes.length;\n    const distArray = [];\n\n    const distMap = new Map();\n    orders.forEach( (each, index) => {\n      distMap.set(index, each.strtLnDist);\n    })\n    \n    for(let i = 0; i < result.length; i++) {\n      const totalDist = result[i].reduce((accum, curr, index, arr) => {\n        let total = 0;\n        if(distMap.has(curr)) total += distMap.get(curr);\n        if(index + 1 < length) {\n          const next = '' + curr + arr[index + 1];\n          if(distMap.has(next)) {\n            total += distMap.get(next)\n          } else {\n            const dist = calcStraightLineDist(orders[curr].destination.geoInfo, orders[arr[index + 1]].origin.geoInfo)\n            distMap.set(next, dist);\n            total += dist;\n          }\n        }\n        return accum + total;\n      }, 0)\n      distArray.push(totalDist);\n    };\n\n    let singleResult = distArray.reduce((accum, curr, index) => {\n      if(index == 0) return {dist: curr, index};\n      if(accum.dist > curr) return {dist: curr, index};\n      return accum;\n    }, {});\n    \n    return singleResult\n  }\n\n  function drawRoute(shortestRoute) {\n    const latLngSet = [];\n    for(let i = 0; i < shortestRoute.length; i++){\n      latLngSet.push(new window.google.maps.LatLng(orders[shortestRoute[i]].origin.geoInfo));\n      latLngSet.push(new window.google.maps.LatLng(orders[shortestRoute[i]].destination.geoInfo))\n    }\n    const wayPoints = latLngSet\n      .filter((item, i) => (i !== 0 && i !== (latLngSet.length -1)))\n      .map( item => { return {location: item, stopover: false}})\n\n    const directionsService = new window.google.maps.DirectionsService();\n\n    let req = {\n      origin: latLngSet[0],\n      destination: latLngSet[latLngSet.length - 1],\n      waypoints: wayPoints,\n      optimizeWaypoints: false,\n      travelMode: 'DRIVING'\n    }\n    \n    return new Promise((resolve, reject) => {\n      directionsService.route(req, (res, status) => {\n        if(status==='OK') {\n          resolve(res.routes[0].overview_polyline)\n        } else {\n          reject(status);\n        }\n      })\n    })\n  }\n\n  function getStops(route) {\n    const stopsArray = [];\n    for(let i = 0; i < route.length; i++){\n      stopsArray.push(orders[route[i]].origin.full_address);\n      stopsArray.push(orders[route[i]].destination.full_address);\n    }\n\n    const filteredStops = stopsArray.filter((stop, index) => {\n      if(index > 0) {\n        if(stop !== stopsArray[index - 1]) return stop;\n      } else { \n        return stop \n      };\n    })\n\n    return filteredStops;\n  }\n\n  function mapRoutes(routes) {\n    removeRoutePolylines();\n    let polycopy = []\n    routes.forEach(route => {\n      const decodedPath = new window.google.maps.geometry.encoding.decodePath(route.route);\n      let polyline = new window.google.maps.Polyline({\n        path: decodedPath,\n        strokeColor: route.color,\n        strokeOpacity: 1.0,\n        strokeWeight: 3,\n      });\n      polyline.setMap(orderMap);\n      polycopy.push(polyline);\n    })\n    setPolylineArray(polycopy);\n  }\n\n  function removeRoutePolylines() {\n    polylineArray.forEach(each => {\n      each.setMap(null);\n    });\n  }\n\n  function toggleRoutePolylines() {\n    polylineArray.forEach(polyline => {\n      (polyline.visible == false) ? polyline.setVisible(true) : polyline.setVisible(false)\n    });\n  }\n\n  function calcStraightLineDist(start, end) {\n    const origin = new window.google.maps.LatLng(start);\n    const dest = new window.google.maps.LatLng(end);\n\n    let distance = window.google.maps.geometry.spherical.computeDistanceBetween(origin, dest);\n    let kms  = distance/1000;\n    \n    return kms\n  }\n\n  return (\n    <ButtonGroup color=\"primary\" variant=\"contained\">\n      <Button onClick={() => optimize()}>1. run the algorithm</Button>\n      <Button onClick={() => createRoute()}>2. create route</Button>\n      <Button onClick={() => toggleRoutePolylines()}>hide routes</Button>\n      <Button onClick={() => removeRoutePolylines()}>remove routes</Button>\n    </ButtonGroup>\n  );\n}\n\nexport default GenRoutes;",{"ruleId":"52","severity":1,"message":"53","line":8,"column":10,"nodeType":"54","messageId":"55","endLine":8,"endColumn":18},{"ruleId":"52","severity":1,"message":"56","line":9,"column":10,"nodeType":"54","messageId":"55","endLine":9,"endColumn":18},{"ruleId":"52","severity":1,"message":"57","line":25,"column":5,"nodeType":"54","messageId":"55","endLine":25,"endColumn":10},{"ruleId":"58","replacedBy":"59"},{"ruleId":"60","replacedBy":"61"},{"ruleId":"52","severity":1,"message":"62","line":5,"column":32,"nodeType":"54","messageId":"55","endLine":5,"endColumn":40},{"ruleId":"52","severity":1,"message":"63","line":6,"column":8,"nodeType":"54","messageId":"55","endLine":6,"endColumn":11},{"ruleId":"64","severity":1,"message":"65","line":41,"column":6,"nodeType":"66","endLine":41,"endColumn":16,"suggestions":"67"},{"ruleId":"64","severity":1,"message":"68","line":45,"column":6,"nodeType":"66","endLine":45,"endColumn":19,"suggestions":"69"},{"ruleId":"64","severity":1,"message":"70","line":49,"column":6,"nodeType":"66","endLine":49,"endColumn":17,"suggestions":"71"},{"ruleId":"64","severity":1,"message":"72","line":53,"column":6,"nodeType":"66","endLine":53,"endColumn":14,"suggestions":"73"},{"ruleId":"74","severity":1,"message":"75","line":190,"column":20,"nodeType":"76","messageId":"77","endLine":190,"endColumn":22},{"ruleId":"74","severity":1,"message":"75","line":210,"column":25,"nodeType":"76","messageId":"77","endLine":210,"endColumn":27},{"ruleId":"78","severity":1,"message":"79","line":253,"column":1,"nodeType":"80","messageId":"81","endLine":260,"endColumn":12},{"ruleId":"52","severity":1,"message":"82","line":9,"column":10,"nodeType":"54","messageId":"55","endLine":9,"endColumn":16},{"ruleId":"64","severity":1,"message":"83","line":27,"column":6,"nodeType":"66","endLine":27,"endColumn":14,"suggestions":"84"},{"ruleId":"74","severity":1,"message":"75","line":97,"column":16,"nodeType":"76","messageId":"77","endLine":97,"endColumn":18},{"ruleId":"85","severity":1,"message":"86","line":143,"column":59,"nodeType":"87","messageId":"88","endLine":143,"endColumn":61},{"ruleId":"74","severity":1,"message":"75","line":179,"column":25,"nodeType":"76","messageId":"77","endLine":179,"endColumn":27},"no-unused-vars","'addOrder' is defined but never used.","Identifier","unusedVar","'addRoute' is defined but never used.","'order' is assigned a value but never used.","no-native-reassign",["89"],"no-negated-in-lhs",["90"],"'TabPanel' is defined but never used.","'app' is defined but never used.","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'setAutoComplete'. Either include it or remove the dependency array.","ArrayExpression",["91"],"React Hook useEffect has a missing dependency: 'originMarker'. Either include it or remove the dependency array.",["92"],"React Hook useEffect has a missing dependency: 'destMarker'. Either include it or remove the dependency array.",["93"],"React Hook useEffect has a missing dependency: 'mapOrders'. Either include it or remove the dependency array.",["94"],"eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","no-lone-blocks","Block is redundant.","BlockStatement","redundantBlock","'result' is assigned a value but never used.","React Hook useEffect has a missing dependency: 'mapRoutes'. Either include it or remove the dependency array.",["95"],"array-callback-return","Array.prototype.filter() expects a value to be returned at the end of arrow function.","ArrowFunctionExpression","expectedAtEnd","no-global-assign","no-unsafe-negation",{"desc":"96","fix":"97"},{"desc":"98","fix":"99"},{"desc":"100","fix":"101"},{"desc":"102","fix":"103"},{"desc":"104","fix":"105"},"Update the dependencies array to be: [orderMap, setAutoComplete]",{"range":"106","text":"107"},"Update the dependencies array to be: [originMarker, originPlace]",{"range":"108","text":"109"},"Update the dependencies array to be: [destMarker, destPlace]",{"range":"110","text":"111"},"Update the dependencies array to be: [mapOrders, orders]",{"range":"112","text":"113"},"Update the dependencies array to be: [mapRoutes, routes]",{"range":"114","text":"115"},[1232,1242],"[orderMap, setAutoComplete]",[1318,1331],"[originMarker, originPlace]",[1403,1414],"[destMarker, destPlace]",[1459,1467],"[mapOrders, orders]",[977,985],"[mapRoutes, routes]"]